---
title: ìë°”ì˜ ìŠ¤ë ˆë“œ
excerpt: í”„ë¡œì„¸ìŠ¤ì˜ ì •ì˜ì™€ ì£¼ì†Œ ê³µê°„ì„ ì´í•´í•˜ê³ , í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤. ë˜í•œ ìŠ¤ë ˆë“œì˜ ë“±ì¥ë°°ê²½, ì •ì˜, ì¢…ë¥˜ ê·¸ë¦¬ê³  ìŠ¤ë ˆë“œ ëª¨ë¸ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤.
categories: [What I Learned]
tags: []
image:
  path: /assets/img/wil/covers/java.png
---

## ğŸ” JVMì™€ ìŠ¤ë ˆë“œ
ìë°”ì—ì„œ ìƒì„±ë˜ëŠ” ìŠ¤ë ˆë“œëŠ” ì‚¬ìš©ì ìˆ˜ì¤€ ìŠ¤ë ˆë“œì´ë‹¤. 
ì¦‰, JVMì—ì„œ ìš´ì˜ì²´ì œ ë ˆë²¨ì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤. 
ë”°ë¼ì„œ JVMì€ ì‚¬ìš©ì ìˆ˜ì¤€ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ê³  JNI(Java Native Interface)ë¥¼ í†µí•´ OSì˜ ì»¤ë„ ìŠ¤ë ˆë“œ ìƒì„±í•˜ê³  ë§µí•‘í•œë‹¤.

![JVMê³¼ ìŠ¤ë ˆë“œ](/assets/img/wil/java/thread/jvmêµ¬ì¡°.png)

ì¦‰, ìë°” ìŠ¤ë ˆë“œëŠ” OS ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜í•´ ì‹¤í–‰ ìˆœì„œê°€ ê²°ì •ë˜ë©° ìŠ¤ë ˆë“œ ì‹¤í–‰ ì‹œì ì„ JVMì—ì„œ ì œì–´í•  ìˆ˜ëŠ” ì—†ë‹¤.


## ğŸ” ìŠ¤ë ˆë“œì˜ ìƒíƒœ ê·¸ë˜í”„
![ìŠ¤ë ˆë“œì˜ ìƒíƒœ ê·¸ë˜í”„](/assets/img/wil/java/thread/ìŠ¤ë ˆë“œì‹¤í–‰êµ¬ì¡°.png)

1. ì“°ë ˆë“œë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰í•˜ì§€ ì•Šì€ ìƒíƒœë¥¼ NEWë¼ê³  í•˜ë©°, start() ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì‹¤í–‰ ëŒ€ê¸°(Runnable) ìƒíƒœê°€ ëœë‹¤.Â 
2. ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœì—ì„œ ì°¨ë¡€ëŒ€ë¡œ ì‹¤í–‰ì´ ëœë‹¤.Â 
3. ì£¼ì–´ì§„ ì‹¤í–‰ì‹œê°„ì´ ë‹¤ ë˜ê±°ë‚˜ yield()ê°€ í˜¸ì¶œë˜ë©´ ë‹¤ì‹œ ì‹¤í–‰ ëŒ€ê¸°ìƒíƒœê°€ ëœë‹¤.Â 
4. ì‹¤í–‰ ì¤‘ì— suspend(), sleep(), wait(), join(), I/O blockì— ì˜í•´ ì¼ì‹œì •ì§€ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤.Â 
5. ì¼ì‹œì •ì§€ì‹œê°„ì´ ë‹¤ë˜ê±°ë‚˜ notify(), resume(), interrupt() ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ ë‹¤ì‹œ ì‹¤í–‰ëŒ€ê¸° ìƒíƒœê°€ ëœë‹¤.Â 
6. ì‹¤í–‰ì„ ëª¨ë‘ ë§ˆì¹˜ë©´ ì†Œë©¸(TERMINATED) ëœë‹¤.


## ğŸ” ìŠ¤ë ˆë“œì˜ êµ¬í˜„ê³¼ ì‹¤í–‰
ìŠ¤ë ˆë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì—ëŠ” `Thread.class`ë¥¼ ìƒì†í•˜ëŠ” ë°©ë²•ê³¼ `Runnable` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤. ë‘ ê°€ì§€ ë°©ë²• ëª¨ë‘ run() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### âœï¸ Thread í´ë˜ìŠ¤
Thread í´ë˜ìŠ¤ëŠ” Threadë¥¼ ìƒì†í•œ ìì‹ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œ ë’¤ start() ë©”ì†Œë“œë¥¼ ì´ìš©í•´ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

```java
class ThreadEx extends Thread {
	public void run() { ... }
}

class ThreadMain {
	public static void main(String[] args) {
    	ThreadEx t = new ThreadEx();
        t.start();
    }
}
```

### âœï¸ Runnable ì¸í„°í˜ì´ìŠ¤
Runnableì„ ìƒì†í•œ ìì‹ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œ ë’¤ì— Thread(Runnable target) ìƒì„±ìë¡œ ìì‹ í´ë˜ìŠ¤ë¥¼ ë„˜ê²¨ì£¼ë©´ ëœë‹¤.

```java
public class ThreadEx2 implement Runnable {
	public void run() { ... }
}

public class ThreadMain {
	public static void main(String[] args) {
    	Runnable r = new ThreadEx2();
        Thread t = new Thread(r);
        t.start();
    }
}
```

### âœï¸ Runnableì„ ì‚¬ìš©í•˜ì
Thread í´ë˜ìŠ¤ê°€ java.lang.Thread í´ë˜ìŠ¤ë§Œ ë‹¤ë£¨ê¸° ë•Œë¬¸ì— ë” ì‰¬ì›Œë³´ì´ì§€ë§Œ Runnableì´ ë” ë§ì´ ì‚¬ìš©ë˜ê³  ìˆë‹¤. ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
1. ìë°”ëŠ” ë‹¤ì¤‘ ìƒì†ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ Threadë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì€ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ìƒì†í•  ìˆ˜ ì—†ìŒì„ ì˜ë¯¸í•œë‹¤.
2. Runnable ì¸í„°í˜ì´ìŠ¤ëŠ” Thread ë˜ëŠ” Executors ë“±ì— ì˜í•´ ì‹¤í–‰ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Runnableì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì€ ë””ìì¸ ê²°ì •ì´ë‹¤.
3. Runnableë¡œ ì‘ì—…ì„ ë¶„ë¦¬í•œë‹¤ëŠ” ê²ƒì€ ê·¸ ì‘ì—…ì„ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° ë‹¤ë¥¸ ì‹¤í–‰ìì— ì˜í•´ ì‹¤í–‰ë  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•œë‹¤.

### Start()ì™€ Run() ë©”ì„œë“œ
ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ Threadë¥¼ ìƒì†í•˜ê³  `run()` ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í•´ì„œ run()ì„ í˜¸ì¶œí•´ì•¼ í•  ê²ƒ ê°™ì§€ë§Œ ê·¸ë ‡ì§€ ì•Šë‹¤. ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” `start()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤.

![start](/assets/img/wil/java/thread/start_ìŠ¤íƒ.png)

start() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ë©´ì„œ ìƒˆë¡œìš´ ìŠ¤íƒ ì˜ì—­ì„ í™•ë³´í•˜ê³  run() ë©”ì„œë“œë¥¼ ì‹¤í–‰í•œë‹¤.


## ğŸ” Java Thread API
### âœï¸ sleep()
- ì§€ì •ëœ ì‹œê°„ë™ì•ˆ ìŠ¤ë ˆë“œë¥¼ ë©ˆì¶”ê²Œ í•œë‹¤.
~~~java
void delay(long millis) {
	try {
		Thread.sleep(millis);
	} catch (InterruptedException e) {}
}
~~~

#### âœ… sleep(0)ê³¼ sleep(n)
sleep()ì€ ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œë¡œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ì—¬ ìœ ì €ëª¨ë“œì—ì„œ ì»¤ë„ëª¨ë“œë¡œ ì „í™˜ëœë‹¤. sleep(0)ê³¼ sleep(1)ì˜ ì°¨ì´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
- sleep(0): ë™ì¼í•œ ìš°ì„ ìˆœìœ„ì˜ ìŠ¤ë ˆë“œê°€ ìˆì„ ê²½ìš° ì‹¤í–‰ëŒ€ê¸° ìƒíƒœ ìŠ¤ë ˆë“œì—ê²Œ CPUë¥¼ í• ë‹¹í•˜ê³  ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ì´ ì¼ì–´ë‚˜ë©°, ì—†ë‹¤ë©´ í˜„ì¬ ìŠ¤ë ˆë“œì—ì„œ ëª¨ë“œ ì „í™˜(ì‚¬ìš©ì ìˆ˜ì¤€ -> ì»¤ë„ ìˆ˜ì¤€)ë§Œ ì¼ì–´ë‚œë‹¤.
- sleep(1): í˜„ì¬ ìŠ¤ë ˆë“œë¥¼ ëŒ€ê¸° ìƒíƒœì— ë‘ê³  ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ê²Œ CPUë¥¼ í• ë‹¹í•œë‹¤.

### âœï¸ interrupt()ì™€ interrupted()
- ì§„í–‰ ì¤‘ì¸ ìŠ¤ë ˆë“œ ì‘ì—…ì´ ëë‚˜ê¸° ì „ì— ì¤‘ì§€í•˜ëŠ” ê²½ìš°ì—ëŠ” `interrupt()` ë¥¼ ì´ìš©í•˜ì—¬ ì‘ì—…ì„ ì¤‘ì§€ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
- interrupted()ë¥¼ í˜¸ì¶œí•˜ë©´ interruptedìƒíƒœë¥¼ ë°˜í™˜ í›„ `isInterrupted = false`ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤.

~~~java
// ì“°ë ˆë“œì˜ interrupted ìƒíƒœë¥¼ falseì—ì„œ trueë¡œ ë³€ê²½í•œë‹¤. 
void interrupt() 

// ì“°ë ˆë“œì˜ interruptedìƒíƒœë¥¼ ë°˜í™˜í•œë‹¤. 
boolean isInterrupted 

// í˜„ì¬ ì“°ë ˆë“œì˜ interruptedìƒíƒœë¥¼ ë°˜í™˜ í›„, falseë¡œ ë³€ê²½í•œë‹¤. 
static boolean interrupted()
~~~

~~~java
public class InterruptExample {
    public static void main(String[] args) {
        Thread myThread = new MyThread();
        myThread.start();

        try {
            Thread.sleep(2000); // 2ì´ˆê°„ ëŒ€ê¸°
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        // ìŠ¤ë ˆë“œ ì¸í„°ëŸ½íŠ¸
        myThread.interrupt();
    }
}

class MyThread extends Thread {
    public void run() {
        while (!isInterrupted()) {
            try {
                System.out.println("ìŠ¤ë ˆë“œ ì‹¤í–‰ ì¤‘");
            } catch (InterruptedException e) {
                System.out.println("ì¸í„°ëŸ½íŠ¸ ë°œìƒ");
                // isInterrupted ìƒíƒœëŠ” falseë¡œ ë°”ë€ë‹¤.
                // ìŠ¤ë ˆë“œ ì¸í„°ëŸ½íŠ¸ ìƒíƒœë¥¼ ì²´í¬í•˜ê³  í•„ìš”í•œ ì‘ì—… ìˆ˜í–‰
                // ì˜ˆ: ìì› ì •ë¦¬, ì¢…ë£Œ ë“±
                return; // ìŠ¤ë ˆë“œ ì¢…ë£Œ
            }
        }
    }
}
~~~

### âœï¸ yield()
í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ìŠ¤ë ˆë“œë¥¼ ì¼ì‹œì ìœ¼ë¡œ ì •ì§€ ì‹œí‚¤ê³  ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ ë˜ë„ë¡ ì–‘ë³´(yield)í•œë‹¤. ë‹¤ìŒ ì½”ë“œì—ì„œëŠ” ë‘ ê°œì˜ ì“°ë ˆë“œê°€ ë²ˆê°ˆì•„ê°€ë©´ì„œ ì‹¤í–‰ëœë‹¤.
~~~java
class MyThread extends Thread {
    private String name;

    public MyThread(String name) {
        this.name = name;
    }

    public void run() {
        for (int i = 1; i <= 5; i++) {
            System.out.println(name + ": " + i);
            // ìŠ¤ë ˆë“œ ì‹¤í–‰ ì¤‘ê°„ì— ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ê²Œ ì‹¤í–‰ ê¸°íšŒë¥¼ ì–‘ë³´
            Thread.yield();
        }
    }
}

public class Main {
    public static void main(String[] args) {
        MyThread thread1 = new MyThread("Thread 1");
        MyThread thread2 = new MyThread("Thread 2");

        thread1.start();
        thread2.start();
    }
}
~~~

### âœï¸ Join()
- ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ì‹¤í–‰ì„ ì¤‘ì§€í•˜ê³  ëŒ€ê¸°í•˜ë‹¤ê°€ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë˜ë©´ ì‹¤í–‰ëŒ€ê¸° ìƒíƒœë¡œ ì „í™˜ëœë‹¤.
- Object í´ë˜ìŠ¤ì˜ wait() ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œë¡œ ì—°ê²°ë˜ë©° ì‹œìŠ¤í…œ ì½œì„ í†µí•´ ì»¤ë„ëª¨ë“œë¡œ ìˆ˜í–‰ëœë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ wait() & notify() íë¦„ì„ ê°€ì§€ê³  ì œì–´í•œë‹¤.

## ğŸ”— ì°¸ê³ 
- [ìš°ì•„í•œí˜•ì œë“¤ - ìë°” ê°€ìƒ ìŠ¤ë ˆë“œ](https://techblog.woowahan.com/15398/)
- [ìë°”ì˜ ì •ì„]
- [ì¸í”„ëŸ° - ìë°” ë™ì‹œì„± í”„ë¡œê·¸ë˜ë°(ì •ìˆ˜ì›)]


